import{t as z,b as J}from"./index.43Z_d8hB.js";import{w as U,a9 as N}from"./scheduler.pzfbVsGb.js";import{T as $}from"./CookieManager.P34oS-qs.js";import{D as G}from"./DeezerConfig.Bim8XL35.js";import{H as B,R as H,w as Q,r as V}from"./control.CsvEx2zW.js";function Ce(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function Z(n,o){J(n,1,1,()=>{o.delete(n.key)})}function he(n,o){n.f(),Z(n,o)}function ge(n,o,t,c,C,p,i,h,w,a,e,r){let s=n.length,u=p.length,m=s;const g={};for(;m--;)g[n[m].key]=m;const l=[],d=new Map,F=new Map,y=[];for(m=u;m--;){const f=r(C,p,m),b=t(f);let v=i.get(b);v?c&&y.push(()=>v.p(f,o)):(v=a(b,f),v.c()),d.set(b,l[m]=v),b in g&&F.set(b,Math.abs(m-g[b]))}const S=new Set,k=new Set;function E(f){z(f,1),f.m(h,e),i.set(f.key,f),e=f.first,u--}for(;s&&u;){const f=l[u-1],b=n[s-1],v=f.key,M=b.key;f===b?(e=f.first,s--,u--):d.has(M)?!i.has(v)||S.has(v)?E(f):k.has(M)?s--:F.get(v)>F.get(M)?(k.add(v),E(f)):(S.add(M),s--):(w(b,i),s--)}for(;s--;){const f=n[s];d.has(f.key)||w(f,i)}for(;u;)E(l[u-1]);return U(y),l}var q=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function I(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var O={exports:{}},P,T;function W(){if(T)return P;T=1;var n=1e3,o=n*60,t=o*60,c=t*24,C=c*7,p=c*365.25;P=function(e,r){r=r||{};var s=typeof e;if(s==="string"&&e.length>0)return i(e);if(s==="number"&&isFinite(e))return r.long?w(e):h(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function i(e){if(e=String(e),!(e.length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(r){var s=parseFloat(r[1]),u=(r[2]||"ms").toLowerCase();switch(u){case"years":case"year":case"yrs":case"yr":case"y":return s*p;case"weeks":case"week":case"w":return s*C;case"days":case"day":case"d":return s*c;case"hours":case"hour":case"hrs":case"hr":case"h":return s*t;case"minutes":case"minute":case"mins":case"min":case"m":return s*o;case"seconds":case"second":case"secs":case"sec":case"s":return s*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}function h(e){var r=Math.abs(e);return r>=c?Math.round(e/c)+"d":r>=t?Math.round(e/t)+"h":r>=o?Math.round(e/o)+"m":r>=n?Math.round(e/n)+"s":e+"ms"}function w(e){var r=Math.abs(e);return r>=c?a(e,r,c,"day"):r>=t?a(e,r,t,"hour"):r>=o?a(e,r,o,"minute"):r>=n?a(e,r,n,"second"):e+" ms"}function a(e,r,s,u){var m=r>=s*1.5;return Math.round(e/s)+" "+u+(m?"s":"")}return P}function K(n){t.debug=t,t.default=t,t.coerce=w,t.disable=p,t.enable=C,t.enabled=i,t.humanize=W(),t.destroy=a,Object.keys(n).forEach(e=>{t[e]=n[e]}),t.names=[],t.skips=[],t.formatters={};function o(e){let r=0;for(let s=0;s<e.length;s++)r=(r<<5)-r+e.charCodeAt(s),r|=0;return t.colors[Math.abs(r)%t.colors.length]}t.selectColor=o;function t(e){let r,s=null,u,m;function g(...l){if(!g.enabled)return;const d=g,F=Number(new Date),y=F-(r||F);d.diff=y,d.prev=r,d.curr=F,r=F,l[0]=t.coerce(l[0]),typeof l[0]!="string"&&l.unshift("%O");let S=0;l[0]=l[0].replace(/%([a-zA-Z%])/g,(E,f)=>{if(E==="%%")return"%";S++;const b=t.formatters[f];if(typeof b=="function"){const v=l[S];E=b.call(d,v),l.splice(S,1),S--}return E}),t.formatArgs.call(d,l),(d.log||t.log).apply(d,l)}return g.namespace=e,g.useColors=t.useColors(),g.color=t.selectColor(e),g.extend=c,g.destroy=t.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>s!==null?s:(u!==t.namespaces&&(u=t.namespaces,m=t.enabled(e)),m),set:l=>{s=l}}),typeof t.init=="function"&&t.init(g),g}function c(e,r){const s=t(this.namespace+(typeof r>"u"?":":r)+e);return s.log=this.log,s}function C(e){t.save(e),t.namespaces=e,t.names=[],t.skips=[];let r;const s=(typeof e=="string"?e:"").split(/[\s,]+/),u=s.length;for(r=0;r<u;r++)s[r]&&(e=s[r].replace(/\*/g,".*?"),e[0]==="-"?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))}function p(){const e=[...t.names.map(h),...t.skips.map(h).map(r=>"-"+r)].join(",");return t.enable(""),e}function i(e){if(e[e.length-1]==="*")return!0;let r,s;for(r=0,s=t.skips.length;r<s;r++)if(t.skips[r].test(e))return!1;for(r=0,s=t.names.length;r<s;r++)if(t.names[r].test(e))return!0;return!1}function h(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}function w(e){return e instanceof Error?e.stack||e.message:e}function a(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}var X=K;(function(n,o){var t={};o.formatArgs=C,o.save=p,o.load=i,o.useColors=c,o.storage=h(),o.destroy=(()=>{let a=!1;return()=>{a||(a=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),o.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function c(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function C(a){if(a[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+a[0]+(this.useColors?"%c ":" ")+"+"+n.exports.humanize(this.diff),!this.useColors)return;const e="color: "+this.color;a.splice(1,0,e,"color: inherit");let r=0,s=0;a[0].replace(/%[a-zA-Z%]/g,u=>{u!=="%%"&&(r++,u==="%c"&&(s=r))}),a.splice(s,0,e)}o.log=console.debug||console.log||(()=>{});function p(a){try{a?o.storage.setItem("debug",a):o.storage.removeItem("debug")}catch{}}function i(){let a;try{a=o.storage.getItem("debug")}catch{}return!a&&typeof process<"u"&&"env"in process&&(a=t.DEBUG),a}function h(){try{return localStorage}catch{}}n.exports=X(o);const{formatters:w}=n.exports;w.j=function(a){try{return JSON.stringify(a)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}})(O,O.exports);var Y=O.exports;const ee=I(Y),te=ee("deezer-playlist"),pe=async(n,o)=>{const t=Date.now();try{return await o()}finally{const c=Date.now();console.warn(`### calling ${n} took ${c-t}ms`)}};function A(n,o){throw new B(n,o)}function we(n,o){throw new H(n,o.toString())}new TextEncoder;var L={exports:{}};(function(n,o){(function(t,c){c(o,n)})(q,function(t,c){var C={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};function p(){return"jsonp_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function i(a){try{delete window[a]}catch{window[a]=void 0}}function h(a){var e=document.getElementById(a);e&&document.getElementsByTagName("head")[0].removeChild(e)}function w(a){var e=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],r=a,s=e.timeout||C.timeout,u=e.jsonpCallback||C.jsonpCallback,m=void 0;return new Promise(function(g,l){var d=e.jsonpCallbackFunction||p(),F=u+"_"+d;window[d]=function(S){g({ok:!0,json:function(){return Promise.resolve(S)}}),m&&clearTimeout(m),h(F),i(d)},r+=r.indexOf("?")===-1?"?":"&";var y=document.createElement("script");y.setAttribute("src",""+r+u+"="+d),e.charset&&y.setAttribute("charset",e.charset),e.nonce&&y.setAttribute("nonce",e.nonce),e.referrerPolicy&&y.setAttribute("referrerPolicy",e.referrerPolicy),e.crossorigin&&y.setAttribute("crossorigin","true"),y.id=F,document.getElementsByTagName("head")[0].appendChild(y),m=setTimeout(function(){l(new Error("JSONP request to "+a+" timed out")),i(d),h(F),window[d]=function(){i(d)}},s),y.onerror=function(){l(new Error("JSONP request to "+a+" failed")),i(d),h(F),m&&clearTimeout(m)}})}c.exports=w})})(L,L.exports);var ne=L.exports;const re=I(ne),_=te.extend("call-deezer");async function oe(n){{n.searchParams.set("output","jsonp"),_({fetchJsonp:n.toString()}),console.log("fetchDeezer: "+n.toString());const o=await re(n.toString(),{timeout:1e4});return o.ok||A(500,"error in jsonp call "+n.pathname),o}}async function Fe(n){_(`calling ${n.apiPath}`);const o=new URL(n.apiPath,G.API_URL),t=$.get();t||A(500,"no accessToken in cookies"),o.searchParams.set("access_token",t),n.searchParams&&Object.entries(n.searchParams).forEach(([p,i])=>{o.searchParams.set(p,""+i)});const C=await(await oe(o)).json();return _("call response",C),C.error&&A(500,"error in deezer call "+o.pathname+": "+JSON.stringify(C.error)),C}const j={};function D(n){return n==="local"?localStorage:sessionStorage}function x(n,o,t){const c=(t==null?void 0:t.serializer)??JSON,C=(t==null?void 0:t.storage)??"local";function p(i,h){D(C).setItem(i,c.stringify(h))}if(!j[n]){const i=Q(o,a=>{const e=D(C).getItem(n);e&&a(c.parse(e));{const r=s=>{s.key===n&&a(s.newValue?c.parse(s.newValue):null)};return window.addEventListener("storage",r),()=>window.removeEventListener("storage",r)}}),{subscribe:h,set:w}=i;j[n]={set(a){p(n,a),w(a)},update(a){const e=a(N(i));p(n,e),w(e)},subscribe:h}}return j[n]}const se=x("modeOsPrefers",!1),ae=x("modeUserPrefers",void 0),ce=x("modeCurrent",!1);function ye(){const n=window.matchMedia("(prefers-color-scheme: light)").matches;return se.set(n),n}function be(n){ae.set(n)}function ve(n){const o=document.documentElement.classList,t="dark";n===!0?o.remove(t):o.add(t),ce.set(n)}function Se(){const n=document.documentElement.classList,o=localStorage.getItem("modeUserPrefers")==="false",t=!("modeUserPrefers"in localStorage),c=window.matchMedia("(prefers-color-scheme: dark)").matches;o||t&&c?n.add("dark"):n.remove("dark")}const R="(prefers-reduced-motion: reduce)";function ie(){return window.matchMedia(R).matches}const Ee=V(ie(),n=>{{const o=c=>{n(c.matches)},t=window.matchMedia(R);return t.addEventListener("change",o),()=>{t.removeEventListener("change",o)}}});export{te as R,ve as a,ye as b,Fe as c,be as d,Ce as e,he as f,I as g,ce as m,Z as o,Ee as p,we as r,Se as s,pe as t,ge as u};
