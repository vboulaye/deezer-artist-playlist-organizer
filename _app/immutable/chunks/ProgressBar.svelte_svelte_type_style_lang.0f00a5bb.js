import{a as R,t as J}from"./index.975caa0b.js";import{L as U,a4 as N}from"./scheduler.2b679851.js";import{T as $}from"./CookieManager.c7cee2e3.js";import{D as G}from"./DeezerConfig.d6648b2c.js";import{H as B}from"./control.f5b05b5f.js";import{w as H,r as Q}from"./paths.bc716bc7.js";function Ce(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function V(n,s){J(n,1,1,()=>{s.delete(n.key)})}function he(n,s){n.f(),V(n,s)}function ge(n,s,t,i,h,w,u,g,c,a,e,r){let o=n.length,m=w.length,C=o;const p={};for(;C--;)p[n[C].key]=C;const l=[],d=new Map,F=new Map,y=[];for(C=m;C--;){const f=r(h,w,C),b=t(f);let v=u.get(b);v?i&&y.push(()=>v.p(f,s)):(v=a(b,f),v.c()),d.set(b,l[C]=v),b in p&&F.set(b,Math.abs(C-p[b]))}const E=new Set,k=new Set;function S(f){R(f,1),f.m(g,e),u.set(f.key,f),e=f.first,m--}for(;o&&m;){const f=l[m-1],b=n[o-1],v=f.key,M=b.key;f===b?(e=f.first,o--,m--):d.has(M)?!u.has(v)||E.has(v)?S(f):k.has(M)?o--:F.get(v)>F.get(M)?(k.add(v),S(f)):(E.add(M),o--):(c(b,u),o--)}for(;o--;){const f=n[o];d.has(f.key)||c(f,u)}for(;m;)S(l[m-1]);return U(y),l}var Z=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function I(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var O={exports:{}},P,T;function q(){if(T)return P;T=1;var n=1e3,s=n*60,t=s*60,i=t*24,h=i*7,w=i*365.25;P=function(e,r){r=r||{};var o=typeof e;if(o==="string"&&e.length>0)return u(e);if(o==="number"&&isFinite(e))return r.long?c(e):g(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function u(e){if(e=String(e),!(e.length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(r){var o=parseFloat(r[1]),m=(r[2]||"ms").toLowerCase();switch(m){case"years":case"year":case"yrs":case"yr":case"y":return o*w;case"weeks":case"week":case"w":return o*h;case"days":case"day":case"d":return o*i;case"hours":case"hour":case"hrs":case"hr":case"h":return o*t;case"minutes":case"minute":case"mins":case"min":case"m":return o*s;case"seconds":case"second":case"secs":case"sec":case"s":return o*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}function g(e){var r=Math.abs(e);return r>=i?Math.round(e/i)+"d":r>=t?Math.round(e/t)+"h":r>=s?Math.round(e/s)+"m":r>=n?Math.round(e/n)+"s":e+"ms"}function c(e){var r=Math.abs(e);return r>=i?a(e,r,i,"day"):r>=t?a(e,r,t,"hour"):r>=s?a(e,r,s,"minute"):r>=n?a(e,r,n,"second"):e+" ms"}function a(e,r,o,m){var C=r>=o*1.5;return Math.round(e/o)+" "+m+(C?"s":"")}return P}function W(n){t.debug=t,t.default=t,t.coerce=c,t.disable=w,t.enable=h,t.enabled=u,t.humanize=q(),t.destroy=a,Object.keys(n).forEach(e=>{t[e]=n[e]}),t.names=[],t.skips=[],t.formatters={};function s(e){let r=0;for(let o=0;o<e.length;o++)r=(r<<5)-r+e.charCodeAt(o),r|=0;return t.colors[Math.abs(r)%t.colors.length]}t.selectColor=s;function t(e){let r,o=null,m,C;function p(...l){if(!p.enabled)return;const d=p,F=Number(new Date),y=F-(r||F);d.diff=y,d.prev=r,d.curr=F,r=F,l[0]=t.coerce(l[0]),typeof l[0]!="string"&&l.unshift("%O");let E=0;l[0]=l[0].replace(/%([a-zA-Z%])/g,(S,f)=>{if(S==="%%")return"%";E++;const b=t.formatters[f];if(typeof b=="function"){const v=l[E];S=b.call(d,v),l.splice(E,1),E--}return S}),t.formatArgs.call(d,l),(d.log||t.log).apply(d,l)}return p.namespace=e,p.useColors=t.useColors(),p.color=t.selectColor(e),p.extend=i,p.destroy=t.destroy,Object.defineProperty(p,"enabled",{enumerable:!0,configurable:!1,get:()=>o!==null?o:(m!==t.namespaces&&(m=t.namespaces,C=t.enabled(e)),C),set:l=>{o=l}}),typeof t.init=="function"&&t.init(p),p}function i(e,r){const o=t(this.namespace+(typeof r>"u"?":":r)+e);return o.log=this.log,o}function h(e){t.save(e),t.namespaces=e,t.names=[],t.skips=[];let r;const o=(typeof e=="string"?e:"").split(/[\s,]+/),m=o.length;for(r=0;r<m;r++)o[r]&&(e=o[r].replace(/\*/g,".*?"),e[0]==="-"?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))}function w(){const e=[...t.names.map(g),...t.skips.map(g).map(r=>"-"+r)].join(",");return t.enable(""),e}function u(e){if(e[e.length-1]==="*")return!0;let r,o;for(r=0,o=t.skips.length;r<o;r++)if(t.skips[r].test(e))return!1;for(r=0,o=t.names.length;r<o;r++)if(t.names[r].test(e))return!0;return!1}function g(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}function c(e){return e instanceof Error?e.stack||e.message:e}function a(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}var K=W;(function(n,s){s.formatArgs=i,s.save=h,s.load=w,s.useColors=t,s.storage=u(),s.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),s.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function i(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+n.exports.humanize(this.diff),!this.useColors)return;const a="color: "+this.color;c.splice(1,0,a,"color: inherit");let e=0,r=0;c[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(e++,o==="%c"&&(r=e))}),c.splice(r,0,a)}s.log=console.debug||console.log||(()=>{});function h(c){try{c?s.storage.setItem("debug",c):s.storage.removeItem("debug")}catch{}}function w(){let c;try{c=s.storage.getItem("debug")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c={}.DEBUG),c}function u(){try{return localStorage}catch{}}n.exports=K(s);const{formatters:g}=n.exports;g.j=function(c){try{return JSON.stringify(c)}catch(a){return"[UnexpectedJSONParseError]: "+a.message}}})(O,O.exports);var X=O.exports;const Y=I(X),ee=Y("deezer-playlist"),pe=async(n,s)=>{const t=Date.now();try{return await s()}finally{const i=Date.now();console.warn(`### calling ${n} took ${i-t}ms`)}};function A(n,s){return new B(n,s)}new TextEncoder;var L={exports:{}};(function(n,s){(function(t,i){i(s,n)})(Z,function(t,i){var h={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};function w(){return"jsonp_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function u(a){try{delete window[a]}catch{window[a]=void 0}}function g(a){var e=document.getElementById(a);e&&document.getElementsByTagName("head")[0].removeChild(e)}function c(a){var e=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],r=a,o=e.timeout||h.timeout,m=e.jsonpCallback||h.jsonpCallback,C=void 0;return new Promise(function(p,l){var d=e.jsonpCallbackFunction||w(),F=m+"_"+d;window[d]=function(E){p({ok:!0,json:function(){return Promise.resolve(E)}}),C&&clearTimeout(C),g(F),u(d)},r+=r.indexOf("?")===-1?"?":"&";var y=document.createElement("script");y.setAttribute("src",""+r+m+"="+d),e.charset&&y.setAttribute("charset",e.charset),e.nonce&&y.setAttribute("nonce",e.nonce),e.referrerPolicy&&y.setAttribute("referrerPolicy",e.referrerPolicy),e.crossorigin&&y.setAttribute("crossorigin","true"),y.id=F,document.getElementsByTagName("head")[0].appendChild(y),C=setTimeout(function(){l(new Error("JSONP request to "+a+" timed out")),u(d),g(F),window[d]=function(){u(d)}},o),y.onerror=function(){l(new Error("JSONP request to "+a+" failed")),u(d),g(F),C&&clearTimeout(C)}})}i.exports=c})})(L,L.exports);var te=L.exports;const ne=I(te),_=ee.extend("call-deezer");async function re(n){{n.searchParams.set("output","jsonp"),_({fetchJsonp:n.toString()}),console.log("fetchDeezer: "+n.toString());const s=await ne(n.toString(),{timeout:1e4});if(!s.ok)throw A(500,"error in jsonp call "+n.pathname);return s}}async function we(n){_(`calling ${n.apiPath}`);const s=new URL(n.apiPath,G.API_URL),t=$.get();if(!t)throw A(500,"no accessToken in cookies");s.searchParams.set("access_token",t),n.searchParams&&Object.entries(n.searchParams).forEach(([w,u])=>{s.searchParams.set(w,""+u)});const h=await(await re(s)).json();if(_("call response",h),h.error)throw A(500,"error in deezer call "+s.pathname+": "+JSON.stringify(h.error));return h}const j={};function D(n){return n==="local"?localStorage:sessionStorage}function x(n,s,t){const i=(t==null?void 0:t.serializer)??JSON,h=(t==null?void 0:t.storage)??"local";function w(u,g){D(h).setItem(u,i.stringify(g))}if(!j[n]){const u=H(s,a=>{const e=D(h).getItem(n);e&&a(i.parse(e));{const r=o=>{o.key===n&&a(o.newValue?i.parse(o.newValue):null)};return window.addEventListener("storage",r),()=>window.removeEventListener("storage",r)}}),{subscribe:g,set:c}=u;j[n]={set(a){w(n,a),c(a)},update(a){const e=a(N(u));w(n,e),c(e)},subscribe:g}}return j[n]}const oe=x("modeOsPrefers",!1),se=x("modeUserPrefers",void 0),ae=x("modeCurrent",!1);function Fe(){const n=window.matchMedia("(prefers-color-scheme: light)").matches;return oe.set(n),n}function ye(n){se.set(n)}function be(n){const s=document.documentElement.classList,t="dark";n===!0?s.remove(t):s.add(t),ae.set(n)}function ve(){const n=document.documentElement.classList,s=localStorage.getItem("modeUserPrefers")==="false",t=!("modeUserPrefers"in localStorage),i=window.matchMedia("(prefers-color-scheme: dark)").matches;s||t&&i?n.add("dark"):n.remove("dark")}const z="(prefers-reduced-motion: reduce)";function ce(){return window.matchMedia(z).matches}const Ee=Q(ce(),n=>{{const s=i=>{n(i.matches)},t=window.matchMedia(z);return t.addEventListener("change",s),()=>{t.removeEventListener("change",s)}}});export{ee as R,be as a,ye as b,we as c,I as d,Ce as e,he as f,Fe as g,ae as m,V as o,Ee as p,ve as s,pe as t,ge as u};
