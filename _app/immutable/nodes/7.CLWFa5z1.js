import{e as Ut,f as bt,d as tt,i as Zt,b as Yt,r as $t,g as ft,j as xe,R as we,c as zt,u as $e,h as Ae,q as Pe,v as Te,s as ue}from"../chunks/ProgressBar.svelte_svelte_type_style_lang.Chf4KSy6.js";import{l as Se,d as ve,f as Ce,g as Wt,c as Kt,h as Ie,b as Be,P as Re}from"../chunks/PlaylistApplicationShell._cT8eg52.js";import{c as ct,a as u,t as w,n as _t,b as Lt}from"../chunks/disclose-version.DIxtxRN2.js";import{j as Le,w as ze,ad as De,e as ut,aI as Z,B as x,J as B,aJ as Ht,f as U,i as f,r as v,t as T,A as o,g as vt,aK as J,s as C,aq as Ft,aG as Bt,aF as Rt,L as St,K as wt,n as At,y as fe,D as ge}from"../chunks/utils.BwDD-hkd.js";import{s as ht}from"../chunks/render.BznOy0_7.js";import{i as at}from"../chunks/if.B5ib3keC.js";import{l as Ct,a as h,c as Qt,r as pt,p as xt,o as Oe,b as Ee}from"../chunks/index-client.DDH4I2Nh.js";import{s as Jt,a as Nt,m as Ne,b as re}from"../chunks/store.CZePPtrh.js";import{d as je,w as me}from"../chunks/control.BoUAPlpW.js";import{s as ne,t as le,H as jt,g as He,c as Me}from"../chunks/contextKeys.kZGIiyP2.js";import{r as Tt,s as et,c as gt,d as Fe,a as Ue,e as Ke}from"../chunks/attributes.CEaAIHiy.js";import{i as Dt}from"../chunks/lifecycle.DllKt3QR.js";import{f as K,d as Ot}from"../chunks/utils.DtLIpg77.js";import{b as Je}from"../chunks/this.7s_3ON2M.js";import{i as qe}from"../chunks/entry.DJwYkKyy.js";function Ge(e,t,n=t){var a=t(),r=()=>{a!==e.paused&&n(a=e.paused)};Se(e,["play","pause","canplay"],r,a==null),Le(()=>{(a=!!t())!==e.paused&&(a?e.pause():e.play().catch(()=>{n(a=!0)}))})}function Ve(e,t,n){var a=De(e,t);a&&a.set&&(e[t]=n,ze(()=>{e[t]=null}))}var Ze=w('<button type="button"><!></button>'),Ye=w("<span><!></span>"),We=w('<div data-testid="rating-bar"></div>');function Qe(e,t){const n=Ct(t,["children","$$slots","$$events","$$legacy"]);ut(t,!1);const a=J();let r=h(t,"value",8,0),c=h(t,"max",8,5),s=h(t,"interactive",8,!1),i=h(t,"text",8,"text-token"),l=h(t,"fill",8,"fill-token"),d=h(t,"justify",8,"justify-center"),g=h(t,"spacing",8,"space-x-2"),m=h(t,"regionIcon",8,"");const y=Qt();function S(b){y("icon",{index:b+1})}function L(b,j){return Math.floor(b)>=j+1}function D(b,j){return b===j+.5}const p="w-full flex";Z(()=>(B(i()),B(l()),B(d()),B(g()),B(n)),()=>{x(a,`${p} ${i()} ${l()} ${d()} ${g()} ${n.class??""}`)}),Ht(),Dt();var O=We();Ut(O,5,()=>({length:c()}),Zt,(b,j,E)=>{var q=ct(),st=U(q);at(st,s,G=>{var Y=Ze(),W=f(Y);at(W,()=>L(r(),E),_=>{var I=ct(),H=U(I);bt(H,t,"full",{},null),u(_,I)},_=>{var I=ct(),H=U(I);at(H,()=>D(r(),E),R=>{var A=ct(),N=U(A);bt(N,t,"half",{},null),u(R,A)},R=>{var A=ct(),N=U(A);bt(N,t,"empty",{},null),u(R,A)},!0),u(_,I)}),v(Y),T(()=>tt(Y,`rating-icon ${m()??""}`)),K("click",Y,()=>S(E)),u(G,Y)},G=>{var Y=Ye(),W=f(Y);at(W,()=>L(r(),E),_=>{var I=ct(),H=U(I);bt(H,t,"full",{},null),u(_,I)},_=>{var I=ct(),H=U(I);at(H,()=>D(r(),E),R=>{var A=ct(),N=U(A);bt(N,t,"half",{},null),u(R,A)},R=>{var A=ct(),N=U(A);bt(N,t,"empty",{},null),u(R,A)},!0),u(_,I)}),v(Y),T(()=>tt(Y,`rating-icon ${m()??""}`)),u(G,Y)}),u(b,q)}),v(O),T(()=>tt(O,`ratings ${o(a)??""}`)),u(e,O),vt()}var Xe=w('<div class="slide-toggle-text ml-3"><!></div>'),ta=w('<div data-testid="slide-toggle" role="switch" tabindex="0"><label><input> <div><div></div></div> <!></label></div>');function ea(e,t){const n=Yt(t),a=Ct(t,["children","$$slots","$$events","$$legacy"]),r=Ct(a,["name","checked","size","background","active","border","rounded","label"]);ut(t,!1);const c=J(),s=J(),i=J(),l=J(),d=J(),g=J(),m=J(),y=J(),S=Qt();let L=h(t,"name",8),D=h(t,"checked",12,!1),p=h(t,"size",8,"md"),O=h(t,"background",8,"bg-surface-400 dark:bg-surface-700"),b=h(t,"active",8,"bg-surface-900 dark:bg-surface-300"),j=h(t,"border",8,""),E=h(t,"rounded",8,"rounded-full"),q=h(t,"label",8,"");const st="inline-block",G="unstyled flex items-center",Y="flex transition-all duration-[200ms] cursor-pointer",W="w-[50%] h-full scale-[0.8] transition-all duration-[200ms] shadow";let _=J();switch(p()){case"sm":x(_,"w-12 h-6");break;case"lg":x(_,"w-20 h-10");break;default:x(_,"w-16 h-8")}function I($){["Enter","Space"].includes($.code)&&($.preventDefault(),S("keyup",$),$.currentTarget.firstChild.click())}function H(){return delete r.class,r}Z(()=>(B(D()),B(b()),B(O())),()=>{x(c,D()?b():`${O()} cursor-pointer`)}),Z(()=>B(D()),()=>{x(s,D()?"bg-white/75":"bg-white")}),Z(()=>B(D()),()=>{x(i,D()?"translate-x-full":"")}),Z(()=>B(a),()=>{x(l,a.disabled===!0?"opacity-50":"hover:brightness-[105%] dark:hover:brightness-110 cursor-pointer")}),Z(()=>(B(E()),o(l),B(a)),()=>{x(d,`${st} ${E()} ${o(l)} ${a.class??""}`)}),Z(()=>{},()=>{x(g,`${G}`)}),Z(()=>(B(j()),B(E()),o(_),o(c)),()=>{x(m,`${Y} ${j()} ${E()} ${o(_)} ${o(c)}`)}),Z(()=>(B(E()),o(s),o(i)),()=>{x(y,`${W} ${E()} ${o(s)} ${o(i)}`)}),Ht(),Dt();var R=ta(),A=f(R),N=f(A);Tt(N);const X=Ft(H);let it;var Q=C(N,2),nt=f(Q);v(Q);var mt=C(Q,2);at(mt,()=>n.default,$=>{var k=Xe(),P=f(k);bt(P,t,"default",{},null),v(k),u($,k)}),v(A),v(R),T(()=>{et(R,"id",q()),tt(R,`slide-toggle ${o(d)??""}`),et(R,"aria-label",q()),et(R,"aria-checked",D()),tt(A,`slide-toggle-label ${o(g)??""}`),it=gt(N,it,{type:"checkbox",class:"slide-toggle-input hidden",name:L(),...o(X),disabled:a.disabled}),tt(Q,`slide-toggle-track ${o(m)??""}`),$t(Q,"cursor-not-allowed",a.disabled),tt(nt,`slide-toggle-thumb ${o(y)??""}`),$t(nt,"cursor-not-allowed",a.disabled)}),ve(N,D),K("click",N,function($){ft.call(this,t,$)}),K("keydown",N,function($){ft.call(this,t,$)}),K("keyup",N,function($){ft.call(this,t,$)}),K("keypress",N,function($){ft.call(this,t,$)}),K("mouseover",N,function($){ft.call(this,t,$)}),K("change",N,function($){ft.call(this,t,$)}),K("focus",N,function($){ft.call(this,t,$)}),K("blur",N,function($){ft.call(this,t,$)}),K("keydown",R,I),u(e,R),vt()}var aa=w('<div role="tabpanel" tabindex="0"><!></div>'),sa=w('<div data-testid="tab-group"><div role="tablist"><!></div> <!></div>');function ra(e,t){const n=Yt(t),a=Ct(t,["children","$$slots","$$events","$$legacy"]);ut(t,!1);const r=J(),c=J(),s=J();let i=h(t,"justify",8,"justify-start"),l=h(t,"border",8,"border-b border-surface-400-500-token"),d=h(t,"active",8,"border-b-2 border-surface-900-50-token"),g=h(t,"hover",8,"hover:variant-soft"),m=h(t,"flex",8,"flex-none"),y=h(t,"padding",8,"px-4 py-2"),S=h(t,"rounded",8,"rounded-tl-container-token rounded-tr-container-token"),L=h(t,"spacing",8,"space-y-1"),D=h(t,"regionList",8,""),p=h(t,"regionPanel",8,""),O=h(t,"labelledby",8,""),b=h(t,"panel",8,"");Bt("active",d()),Bt("hover",g()),Bt("flex",m()),Bt("padding",y()),Bt("rounded",S()),Bt("spacing",L());const j="space-y-4",E="flex overflow-x-auto hide-scrollbar",q="";Z(()=>B(a),()=>{x(r,`${j} ${a.class??""}`)}),Z(()=>(B(i()),B(l()),B(D())),()=>{x(c,`${E} ${i()} ${l()} ${D()}`)}),Z(()=>B(p()),()=>{x(s,`${q} ${p()}`)}),Ht(),Dt();var st=sa(),G=f(st),Y=f(G);bt(Y,t,"default",{},null),v(G);var W=C(G,2);at(W,()=>n.panel,_=>{var I=aa(),H=f(I);bt(H,t,"panel",{},null),v(I),T(()=>{tt(I,`tab-panel ${o(s)??""}`),et(I,"aria-labelledby",b())}),u(_,I)}),v(st),T(()=>{tt(st,`tab-group ${o(r)??""}`),tt(G,`tab-list ${o(c)??""}`),et(G,"aria-labelledby",O())}),u(e,st),vt()}var na=w('<div class="tab-lead"><!></div>'),la=w('<label><div data-testid="tab" role="tab"><div class="h-0 w-0 overflow-hidden"><input></div> <div><!> <div class="tab-label"><!></div></div></div></label>');function Mt(e,t){const n=Yt(t),a=Ct(t,["children","$$slots","$$events","$$legacy"]),r=Ct(a,["group","name","value","title","controls","regionTab","active","hover","flex","padding","rounded","spacing"]);ut(t,!1);const c=J(),s=J(),i=J(),l=J(),d=J(),g=[];let m=h(t,"group",12),y=h(t,"name",8),S=h(t,"value",8),L=h(t,"title",8,""),D=h(t,"controls",8,""),p=h(t,"regionTab",8,""),O=h(t,"active",24,()=>Rt("active")),b=h(t,"hover",24,()=>Rt("hover")),j=h(t,"flex",24,()=>Rt("flex")),E=h(t,"padding",24,()=>Rt("padding")),q=h(t,"rounded",24,()=>Rt("rounded")),st=h(t,"spacing",24,()=>Rt("spacing"));const G="text-center cursor-pointer transition-colors duration-100",Y="";let W=J();function _(k){if(["Enter","Space"].includes(k.code))k.preventDefault(),o(W).click();else if(k.code==="ArrowRight"){const P=o(W).closest(".tab-list");if(!P)return;const M=Array.from(P.querySelectorAll(".tab")),F=o(W).closest(".tab");if(!F)return;const rt=M.indexOf(F),ot=rt+1>=M.length?0:rt+1,lt=M[ot],V=lt==null?void 0:lt.querySelector("input");lt&&V&&(V.click(),lt.focus())}else if(k.code==="ArrowLeft"){const P=o(W).closest(".tab-list");if(!P)return;const M=Array.from(P.querySelectorAll(".tab")),F=o(W).closest(".tab");if(!F)return;const rt=M.indexOf(F),ot=rt-1<0?M.length-1:rt-1,lt=M[ot],V=lt==null?void 0:lt.querySelector("input");lt&&V&&(V.click(),lt.focus())}}function I(){return delete r.class,r}Z(()=>(B(S()),B(m())),()=>{x(c,S()===m())}),Z(()=>(o(c),B(O()),B(b())),()=>{x(s,o(c)?O():b())}),Z(()=>(B(j()),B(E()),B(q()),o(s),B(a)),()=>{x(i,`${G} ${j()} ${E()} ${q()} ${o(s)} ${a.class??""}`)}),Z(()=>B(st()),()=>{x(l,`${Y} ${st()}`)}),Z(()=>B(p()),()=>{x(d,`${p()}`)}),Ht(),Dt();var H=la(),R=f(H),A=f(R),N=f(A);Je(N,k=>x(W,k),()=>o(W)),Tt(N);const X=Ft(I);let it;v(A);var Q=C(A,2),nt=f(Q);at(nt,()=>n.lead,k=>{var P=na(),M=f(P);bt(M,t,"lead",{},null),v(P),u(k,P)});var mt=C(nt,2),$=f(mt);bt($,t,"default",{},null),v(mt),v(Q),v(R),v(H),T(()=>{tt(H,o(i)),et(H,"title",L()),tt(R,`tab ${o(d)??""}`),et(R,"aria-controls",D()),et(R,"aria-selected",o(c)),et(R,"tabindex",o(c)?0:-1),it=gt(N,it,{type:"radio",name:y(),value:S(),...o(X),tabindex:"-1"}),tt(Q,`tab-interface ${o(l)??""}`)}),Ce(g,[],N,()=>(S(),m()),m),K("click",N,function(k){ft.call(this,t,k)}),K("change",N,function(k){ft.call(this,t,k)}),K("keydown",R,_),K("keydown",R,function(k){ft.call(this,t,k)}),K("keyup",R,function(k){ft.call(this,t,k)}),K("keypress",R,function(k){ft.call(this,t,k)}),u(e,H),vt()}var Xt={exports:{}};function he(){var e=Object.create(null),t=0,n=0,a=0,r=!1;this.put=function(s,i,l,d){if(r&&console.log("caching: %s = %j (@%s)",s,i,l),typeof l<"u"&&(typeof l!="number"||isNaN(l)||l<=0))throw new Error("Cache timeout must be a positive number");if(typeof d<"u"&&typeof d!="function")throw new Error("Cache timeout callback must be a function");var g=e[s];g?clearTimeout(g.timeout):a++;var m={value:i,expire:l+Date.now()};return isNaN(m.expire)||(m.timeout=setTimeout((function(){c(s),d&&d(s,i)}).bind(this),l)),e[s]=m,i},this.del=function(s){var i=!0,l=e[s];return l?(clearTimeout(l.timeout),!isNaN(l.expire)&&l.expire<Date.now()&&(i=!1)):i=!1,i&&c(s),i};function c(s){a--,delete e[s]}this.clear=function(){for(var s in e)clearTimeout(e[s].timeout);a=0,e=Object.create(null),r&&(t=0,n=0)},this.get=function(s){var i=e[s];if(typeof i<"u"){if(isNaN(i.expire)||i.expire>=Date.now())return r&&t++,i.value;r&&n++,a--,delete e[s]}else r&&n++;return null},this.size=function(){return a},this.memsize=function(){var s=0,i;for(i in e)s++;return s},this.debug=function(s){r=s},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var s={};for(var i in e){var l=e[i];s[i]={value:l.value,expire:l.expire||"NaN"}}return JSON.stringify(s)},this.importJson=function(s,i){var l=JSON.parse(s),d=Date.now(),g=i&&i.skipDuplicates;for(var m in l)if(l.hasOwnProperty(m)){if(g){var y=e[m];if(y){r&&console.log("Skipping duplicate imported key '%s'",m);continue}}var S=l[m],L=S.expire-d;if(L<=0){this.del(m);continue}L=L>0?L:void 0,this.put(m,S.value,L)}return this.size()}}Xt.exports=new he;Xt.exports.Cache=he;var ia=Xt.exports;const ie=xe(ia);class pe{constructor(t,n){this.cacheName=t,this.ttl=n}get(t){return ie.get(this.buildKey(t))}buildKey(t){return this.cacheName+"~"+t}put(t,n){ie.put(this.buildKey(t),n,this.ttl)}}const te=we.extend("api-query"),oe=new pe("ARTIST",3600*1e3),ce=new pe("ARTIST-DISCOGRAPHY",3600*1e3);async function oa(e){te("getDeezerArtist "+e);const t=oe.get(e);if(t)return t;const n=await zt({apiPath:"/artist/"+e});return oe.put(e,n),n}async function be(e){return te("getAlbumTracks "+e),await Wt({apiPath:"/album/"+e+"/tracks",index:0,limit:100})}async function _e(e){te("getDeezerArtistDiscography "+e);const t=ce.get(e);if(t)return t;const n=await Wt({apiPath:"/artist/"+e+"/albums",index:0,limit:100}),a=await Promise.all(n.data.map(async r=>{const c=await be(r.id);return{...r,tracks:c.data}}));return ce.put(e,a),a}const ca=!1;async function da(e){if(e==="NEW"){const t=new Date().toISOString(),n=await zt({apiPath:"/user/me/playlists",searchParams:{request_method:"POST",title:`New Playlist ${t}`,description:`Playlist created with deezer-artist-playlist-organizer on the ${t}`,public:!0}});$e(302,"?id="+n.id)}return e}async function ua({url:e,parent:t}){const n=await da(e.searchParams.get("id")??""),a=await zt({apiPath:`/playlist/${n}`});if(a.nb_tracks>400){const l=await Wt({apiPath:`/playlist/${n}/tracks`,limit:100,index:a.tracks.data.length});a.tracks.data=[...a.tracks.data,...l.data]}const r=a.tracks.data.reduce((l,d)=>(l[d.artist.id]||(l[d.artist.id]={artist:d.artist,count:0}),l[d.artist.id].count++,l),{}),c=Object.values(r).toSorted((l,d)=>d.count-l.count),s=Promise.all(c.map(async l=>await oa(l.artist.id)));return{...await t(),playlist:await a,topArtists:await s}}const ir=Object.freeze(Object.defineProperty({__proto__:null,load:ua,ssr:ca},Symbol.toStringTag,{value:"Module"}));var va=_t('<svg><path fill="currentColor" d="M216 36H68.53a20.09 20.09 0 0 0-17.15 9.71L5.71 121.83a12 12 0 0 0 0 12.34l45.67 76.12A20.09 20.09 0 0 0 68.53 220H216a20 20 0 0 0 20-20V56a20 20 0 0 0-20-20m-4 160H70.8L30 128l40.8-68H212Zm-108.49-52.49L119 128l-15.52-15.51a12 12 0 0 1 17-17L136 111l15.51-15.52a12 12 0 0 1 17 17L153 128l15.52 15.51a12 12 0 0 1-17 17L136 145l-15.51 15.52a12 12 0 0 1-17-17Z"></path></svg>');function fa(e,t){const n=pt(t,["$$slots","$$events","$$legacy"]);var a=va();let r;T(()=>r=gt(a,r,{viewBox:"0 0 256 256",width:"1.2em",height:"1.2em",...n},void 0,!0)),u(e,a)}var ga=_t('<svg><path fill="currentColor" d="M160 36a92.09 92.09 0 0 0-81 48.36A68 68 0 1 0 72 220h88a92 92 0 0 0 0-184m0 160H72a44 44 0 0 1-1.82-88A92 92 0 0 0 68 128a12 12 0 0 0 24 0a68 68 0 1 1 68 68m40.49-92.49a12 12 0 0 1 0 17l-48 48a12 12 0 0 1-17 0l-24-24a12 12 0 1 1 17-17L144 143l39.51-39.52a12 12 0 0 1 16.98.03"></path></svg>');function ma(e,t){const n=pt(t,["$$slots","$$events","$$legacy"]);var a=ga();let r;T(()=>r=gt(a,r,{viewBox:"0 0 256 256",width:"1.2em",height:"1.2em",...n},void 0,!0)),u(e,a)}var ha=_t('<svg><path fill="currentColor" d="M117.18 188.74a12 12 0 0 1 0 17l-5.12 5.12A58.26 58.26 0 0 1 70.6 228a58.62 58.62 0 0 1-41.46-100.08l34.75-34.75a58.64 58.64 0 0 1 98.56 28.11a12 12 0 1 1-23.37 5.44a34.65 34.65 0 0 0-58.22-16.58l-34.75 34.75A34.62 34.62 0 0 0 70.57 204a34.4 34.4 0 0 0 24.49-10.14l5.11-5.12a12 12 0 0 1 17.01 0M226.83 45.17a58.65 58.65 0 0 0-82.93 0l-5.11 5.11a12 12 0 0 0 17 17l5.12-5.12a34.63 34.63 0 1 1 49 49l-34.81 34.7A34.4 34.4 0 0 1 150.61 156a34.63 34.63 0 0 1-33.69-26.72a12 12 0 0 0-23.38 5.44A58.64 58.64 0 0 0 150.56 180h.05a58.28 58.28 0 0 0 41.47-17.17l34.75-34.75a58.62 58.62 0 0 0 0-82.91"></path></svg>');function pa(e,t){const n=pt(t,["$$slots","$$events","$$legacy"]);var a=ha();let r;T(()=>r=gt(a,r,{viewBox:"0 0 256 256",width:"1.2em",height:"1.2em",...n},void 0,!0)),u(e,a)}async function ba(e,t,n){const a=e.filter(s=>s.selected&&s.track.readable).length,r=e.filter(s=>s.selected&&!s.track.readable);for(let s=0;s<r.length;s++){const i=r[s];n.set({message:`trying to fix track ${s} / ${r.length}`,value:s,max:r.length});const l=i.track,d=await _a(l,t);if(d){console.log("adding alternative to "+i.track.id+" : "+d.title),i.selected=!1;const g=e.indexOf(i);e.splice(g+1,0,{selected:!0,inPlaylist:!1,track:d})}}const c=e.filter(s=>s.selected&&s.track.readable).length;t.trigger({message:`Reattached ${c-a} track(s) to readable equivalents.<br/>(${e.filter(s=>s.selected).length-c} unreadable track remaining)`,timeout:1e4})}async function _a(e,t){const n=await _e(e.artist.id);if(!n){t.trigger({message:`Could not find artist ${e.artist.name}`,timeout:3e3});return}const a=n.flatMap(s=>{const{tracks:i,...l}=s;return s.tracks.map(d=>({...d,album:l}))}).filter(s=>s.id!==e.id&&s.readable),r={sensitivity:"base",ignorePunctuation:!0,numeric:!1,usage:"search"},c=a.filter(s=>s.title.localeCompare(e.title,void 0,r)===0);switch(c.length){case 0:console.log("no match by title",{unreadableTrack:e}),t.trigger({message:`Could not find matching track for '${e.title}' in album '${e.album.title}' by '${e.artist.name}'`,timeout:3e3});return;case 1:return c[0];default:{const s=Object.values(c.reduce((l,d)=>(l[d.isrc]=d,l),{}));if(s.length===1)return s[0];const i=c.filter(l=>l.album.title.localeCompare(e.album.title,void 0,r)===0);switch(i.length){case 0:console.log("no match by title and album",{unreadableTrack:e}),t.trigger({message:`Could not find matching track for '${e.title}' in album '${e.album.title}' by '${e.artist.name}'`,timeout:3e3});return;case 1:return i[0];default:{const l=Object.values(i.reduce((d,g)=>(d[g.isrc]=g,d),{}));if(l.length===1)return l[0];console.log("multiple match by title",{unreadableTrack:e,matchingTracksByTitleAndAlbum:i}),t.trigger({message:`Found multiple matching tracks for '${e.title}' in album '${e.album.title}' : ${i.map(d=>d.id)}`,timeout:3e3});return}}}}}var ya=w('<button type="button"><!></button>'),ka=w("<li><!></li>"),xa=w("<nav><ul></ul></nav>"),wa=w("<div> </div>"),$a=w('<div data-testid="autocomplete"><!></div>');function Aa(e,t){const n=Ct(t,["children","$$slots","$$events","$$legacy"]);ut(t,!1);const a=Jt(),r=()=>Nt(Pe,"$prefersReducedMotionStore",a),c=J(),s=J(),i=J(),l=J(),d=J(),g=J(),m=J(),y=J(),S=J();function L($,k){const{transition:P,params:M,enabled:F}=k;return F?P($,M):"duration"in M?P($,{duration:0}):{duration:0}}const D=Qt();let p=h(t,"input",8,void 0),O=h(t,"options",24,()=>[]),b=h(t,"limit",8,void 0),j=h(t,"allowlist",24,()=>[]),E=h(t,"denylist",24,()=>[]),q=h(t,"emptyState",8,"No Results Found."),st=h(t,"regionNav",8,""),G=h(t,"regionList",8,"list-nav"),Y=h(t,"regionItem",8,""),W=h(t,"regionButton",8,"w-full"),_=h(t,"regionEmpty",8,"text-center"),I=h(t,"transitions",24,()=>!r()),H=h(t,"transitionIn",8,ne),R=h(t,"transitionInParams",24,()=>({duration:200})),A=h(t,"transitionOut",8,ne),N=h(t,"transitionOutParams",24,()=>({duration:200}));function X($,k){let P=[...O()];$.length&&(P=P.filter(M=>$.includes(M.value))),k.length&&(P=P.filter(M=>!k.includes(M.value))),!$.length&&!k.length&&(P=O()),x(c,P)}function it(){let $=[...o(c)];return $=$.filter(k=>{const P=String(p()).toLowerCase().trim();if(JSON.stringify([k.label,k.value,k.keywords]).toLowerCase().includes(P))return k}),$}function Q($){D("selection",$)}Z(()=>B(O()),()=>{x(c,O())}),Z(()=>(B(j()),B(E())),()=>{X(j(),E())}),Z(()=>(B(p()),o(c)),()=>{x(s,p()?it():o(c))}),Z(()=>(B(b()),o(s)),()=>{x(i,b()!==void 0?b():o(s).length)}),Z(()=>B(n),()=>{x(l,`${n.class??""}`)}),Z(()=>B(st()),()=>{x(d,`${st()}`)}),Z(()=>B(G()),()=>{x(g,`${G()}`)}),Z(()=>B(Y()),()=>{x(m,`${Y()}`)}),Z(()=>B(W()),()=>{x(y,`${W()}`)}),Z(()=>B(_()),()=>{x(S,`${_()}`)}),Ht(),Dt();var nt=$a(),mt=f(nt);return at(mt,()=>o(s).length>0,$=>{var k=xa(),P=f(k);Ut(P,5,()=>o(s).slice(0,o(i)),M=>M,(M,F)=>{var rt=ka(),ot=f(rt);bt(ot,t,"optionButton",{get option(){return o(F)},get classesButton(){return o(y)},onSelection:Q},lt=>{var V=ya(),It=f(V);Ae(It,()=>o(F).label),v(V),T(()=>tt(V,`autocomplete-button ${o(y)??""}`)),K("click",V,()=>Q(o(F))),K("click",V,function(yt){ft.call(this,t,yt)}),K("keypress",V,function(yt){ft.call(this,t,yt)}),u(lt,V)}),v(rt),T(()=>tt(rt,`autocomplete-item ${o(m)??""}`)),le(1,rt,()=>L,()=>({transition:H(),params:R(),enabled:I()})),le(2,rt,()=>L,()=>({transition:A(),params:N(),enabled:I()})),u(M,rt)}),v(P),v(k),T(()=>{tt(k,`autocomplete-nav ${o(d)??""}`),tt(P,`autocomplete-list ${o(g)??""}`)}),u($,k)},$=>{var k=wa(),P=f(k,!0);v(k),T(()=>{tt(k,`autocomplete-empty ${o(S)??""}`),ht(P,q())}),u($,k)}),v(nt),T(()=>tt(nt,`autocomplete ${o(l)??""}`)),u(e,nt),Ve(t,"dynamicTransition",L),vt({dynamicTransition:L})}var Pa=_t('<svg><path fill="currentColor" d="M128 20a108 108 0 1 0 108 108A108.12 108.12 0 0 0 128 20m0 192a84 84 0 1 1 84-84a84.09 84.09 0 0 1-84 84m52-84a12 12 0 0 1-12 12h-28v28a12 12 0 0 1-24 0v-28H88a12 12 0 0 1 0-24h28V88a12 12 0 0 1 24 0v28h28a12 12 0 0 1 12 12"></path></svg>');function ee(e,t){const n=pt(t,["$$slots","$$events","$$legacy"]);var a=Pa();let r;T(()=>r=gt(a,r,{viewBox:"0 0 256 256",width:"1.2em",height:"1.2em",...n},void 0,!0)),u(e,a)}var Ta=(e,t)=>t.onArtistSelection(t.artist),Sa=w('<button type="button"><span class="flex items-center w-1/3"><img alt="artist" class="mx-2"> </span> <span class="w-1/4"><small> </small></span> <span class="btn-group-vertical btn btn-sm gap-y-1"><span class="!p-0" title="add all artist titles to the playlist"><!></span></span></button>');function Ca(e,t){ut(t,!0);let n=St("");var a=Sa();a.__click=[Ta,t];var r=f(a),c=f(r),s=C(c);v(r);var i=C(r,2),l=f(i),d=f(l);v(l),v(i);var g=C(i,2),m=f(g),y=f(m);ee(y,{}),v(m),v(g),v(a),T(()=>{tt(a,`button-icon flex justify-between w-full items-center py-1 cursor-pointer ${o(n)??""}`),et(c,"src",t.artist.picture_small),ht(s,` ${t.artist.name??""}`),ht(d,`${t.artist.nb_album??""} albums`)}),K("pointerenter",a,()=>x(n,"variant-ghost-success")),K("pointerleave",a,()=>x(n,"")),u(e,a),vt()}Ot(["click"]);var Ia=w('<span class="my-4"><input class="input" type="search" name="demo" placeholder="Search..."> <span class="card w-full max-h-fit  p-4 overflow-y-auto inline-block" tabindex="-1"><!></span></span>');function Ba(e,t){ut(t,!0);const n=Jt(),a=()=>Nt(c,"$artistSearch",n),r=()=>Nt(s,"$artistsFound",n),c=me(""),s=je(c,(m,y)=>{if(!m){y([]);return}zt({apiPath:"/search/artist",searchParams:{q:m}}).then(S=>{const L=S.data.map(D=>({label:`<span class="flex justify-between w-full items-center">
<span class="flex items-center"> <img src="${D.picture_small}" class="mx-2"/>${D.name}</span>
 <button class="btn-icon btn-icon-sm variant-outline-tertiary" title="add all artist titles to the playlist">add</button></span>`,value:D.id,meta:D}));y(L)})});var i=Ia(),l=f(i);Tt(l);var d=C(l,2),g=f(d);Aa(g,{get input(){return Ne(),a()},set input(y){re(c,xt(y))},get options(){return r()},optionButton:(y,S)=>{let L=()=>S==null?void 0:S().option;Ca(y,{get artist(){return L().meta},get onArtistSelection(){return t.onArtistSelection}})},$$slots:{optionButton:!0}}),v(d),v(i),Kt(l,a,m=>re(c,m)),u(e,i),vt()}var Ra=_t('<svg><path fill="currentColor" d="M128 128a12 12 0 0 1-12 12H48a12 12 0 0 1 0-24h68a12 12 0 0 1 12 12M48 76h132a12 12 0 0 0 0-24H48a12 12 0 0 0 0 24m52 104H48a12 12 0 0 0 0 24h52a12 12 0 0 0 0-24m132.49-20.49a12 12 0 0 0-17 0L196 179v-67a12 12 0 0 0-24 0v67l-19.51-19.52a12 12 0 0 0-17 17l40 40a12 12 0 0 0 17 0l40-40a12 12 0 0 0 0-16.97"></path></svg>');function La(e,t){const n=pt(t,["$$slots","$$events","$$legacy"]);var a=Ra();let r;T(()=>r=gt(a,r,{viewBox:"0 0 256 256",width:"1.2em",height:"1.2em",...n},void 0,!0)),u(e,a)}var za=_t('<svg><path fill="currentColor" d="M36 128a12 12 0 0 1 12-12h68a12 12 0 0 1 0 24H48a12 12 0 0 1-12-12m12-52h52a12 12 0 0 0 0-24H48a12 12 0 0 0 0 24m132 104H48a12 12 0 0 0 0 24h132a12 12 0 0 0 0-24m52.49-100.49l-40-40a12 12 0 0 0-17 0l-40 40a12 12 0 0 0 17 17L172 77v67a12 12 0 0 0 24 0V77l19.51 19.52a12 12 0 0 0 17-17Z"></path></svg>');function Da(e,t){const n=pt(t,["$$slots","$$events","$$legacy"]);var a=za();let r;T(()=>r=gt(a,r,{viewBox:"0 0 256 256",width:"1.2em",height:"1.2em",...n},void 0,!0)),u(e,a)}function ye(e,t){t.forEach(n=>{n.track.artist.id===e&&(n.selected=!1)})}async function ae(e,t,n){const a=e.id,c=(await _e(a)).toSorted((i,l)=>i.release_date.localeCompare(l.release_date)).flatMap(i=>{const{tracks:l,...d}=i;return i.tracks.map(g=>({...g,album:d}))});c.forEach(i=>{const l=t.find(d=>d.track.id===i.id);l?(l.track.album=i.album,l.selected=!0):t.push({track:i,inPlaylist:!1,selected:!0})});function s(i){return c.findIndex(l=>l.id===i.track.id)}t.sort((i,l)=>{const d=s(i),g=s(l);return d-g}),n.trigger({message:`Added ${c.length} tracks from ${e.name}`,timeout:3e3})}function Oa(e,t){t.forEach(n=>{n.track.album.id===e&&(n.selected=!1)})}async function Ea(e,t){const n=await be(e.id);n.data.forEach(i=>{const l=t.find(d=>d.track.id===i.id);i.album=e,l?(l.track.album=i.album,l.selected=!0):t.push({track:i,inPlaylist:!1,selected:!0})});function a(i){return n.data.findIndex(l=>l.id===i.track.id)+1}function r(i){return t.findIndex(l=>l.track.id===i.track.id)+1}const c=t.findIndex(i=>i.track.album.id===e.id);function s(i){const l=a(i);return l===0?r(i)*1e4:c*1e4+l}t.sort((i,l)=>{const d=c*1e4+s(i),g=c*1e4+s(l);return d-g})}function Vt(e,t){return t.filter(a=>a.track.artist.id===e&&a.selected).length}function Na(e,t){const n=e.filter(a=>a.selected||a.inPlaylist);e.splice(0,e.length,...n),t.trigger({message:`Removed ${e.length-n.length} track(s) from the playlist`,timeout:3e3})}function ja(e,t,n){const a=t.ascending?1:-1,r=(l,d)=>Vt(l.id,n)-Vt(d.id,n),c=(l,d)=>l.name.localeCompare(d.name),s=(l,d)=>(g,m)=>{const y=l(g,m);return y===0?d(g,m):y};return e.sort((l,d)=>{switch(t.orderBy){case"trackCount":return a*s(r,c)(l,d);case"alphabetical":return a*s(c,r)(l,d)}})}var Ha=_t('<svg><path fill="currentColor" d="M180 128a12 12 0 0 1-12 12H88a12 12 0 0 1 0-24h80a12 12 0 0 1 12 12m56 0A108 108 0 1 1 128 20a108.12 108.12 0 0 1 108 108m-24 0a84 84 0 1 0-84 84a84.09 84.09 0 0 0 84-84"></path></svg>');function ke(e,t){const n=pt(t,["$$slots","$$events","$$legacy"]);var a=Ha();let r;T(()=>r=gt(a,r,{viewBox:"0 0 256 256",width:"1.2em",height:"1.2em",...n},void 0,!0)),u(e,a)}const z=xt({playlist:void 0,isUpdatable:!1,trackSelections:[],playlistArtists:[]});var Ma=w("<img> <span> </span>",1),Fa=(e,t)=>ae(t.topArtist,z.trackSelections,t.toastStore),Ua=(e,t)=>ye(t.topArtist.id,z.trackSelections),Ka=w('<li><span class="flex flex-row justify-between w-full items-center gap-x-2"><a title="open artist in Deezer web interface" class="w-1/3"><!></a> <span class="w-1/4"><small> </small></span> <span class="w-1/4"><small> </small></span> <span class="btn-group-vertical btn btn-sm gap-y-1"><button class="!p-0" title="add all artist titles to the playlist"><!></button> <button class="!p-0" title="deselect all artist titles from the playlist"><!></button></span></span></li>');function Ja(e,t){ut(t,!0);let n=wt(()=>Vt(t.topArtist.id,z.trackSelections)),a=St(!1),r=St(!1);var c=Ka(),s=f(c),i=f(s),l=f(i);jt(l,{children:(E,q)=>{var st=Ma(),G=U(st),Y=C(G,2),W=f(Y,!0);v(Y),T(()=>{et(G,"src",t.topArtist.picture_small),et(G,"alt",t.topArtist.name),ht(W,t.topArtist.name)}),u(E,st)},$$slots:{default:!0}}),v(i);var d=C(i,2),g=f(d),m=f(g);v(g),v(d);var y=C(d,2),S=f(y),L=f(S);v(S),v(y);var D=C(y,2),p=f(D);p.__click=[Fa,t];var O=f(p);ee(O,{}),v(p);var b=C(p,2);b.__click=[Ua,t];var j=f(b);ke(j,{}),v(b),v(D),v(s),v(c),T(()=>{$t(c,"variant-ghost-success",o(a)),$t(c,"variant-ghost-error",o(r)),et(i,"href",t.topArtist.link),et(g,"title",`artist has ${o(n)??""} tracks in the playlist `),ht(m,`${o(n)??""} tracks in playlist`),ht(L,`${t.topArtist.nb_album??""} albums`),$t(b,"text-gray-500",o(n)===0)}),K("mouseenter",p,()=>x(a,!0)),K("mouseleave",p,()=>x(a,!1)),K("mouseenter",b,()=>x(r,!0)),K("mouseleave",b,()=>x(r,!1)),u(e,c),vt()}Ot(["click"]);var qa=w("<h4>Playlists Artists</h4>"),Ga=(e,t)=>t({orderBy:"alphabetical"}),Va=w("<button># tracks</button>"),Za=(e,t)=>t({orderBy:"trackCount"}),Ya=w("<button>alphabetical</button>"),Wa=(e,t)=>t({ascending:!1}),Qa=w("<button><!></button>"),Xa=(e,t)=>t({ascending:!0}),ts=w("<button><!></button>"),es=w("<!> <!>",1),as=w('<span class="flex justify-between w-full items-center gap-x-2 my-4"><!> <!></span> <ul class="list"></ul>',1);function ss(e,t){ut(t,!0);const n=xt({ascending:!1,orderBy:"trackCount"});function a(s){s.ascending!==void 0&&(n.ascending=s.ascending),s.orderBy!==void 0&&(n.orderBy=s.orderBy),ja(z.playlistArtists,n,z.trackSelections)}var r=ct(),c=U(r);return at(c,()=>{var s;return((s=z.playlistArtists)==null?void 0:s.length)>0},s=>{var i=as(),l=U(i),d=f(l);jt(d,{children:(y,S)=>{var L=qa();u(y,L)},$$slots:{default:!0}});var g=C(d,2);jt(g,{children:(y,S)=>{var L=es(),D=U(L);at(D,()=>n.orderBy==="trackCount",O=>{var b=Va();b.__click=[Ga,a],u(O,b)},O=>{var b=ct(),j=U(b);at(j,()=>n.orderBy==="alphabetical",E=>{var q=Ya();q.__click=[Za,a],u(E,q)},null,!0),u(O,b)});var p=C(D,2);at(p,()=>n.ascending,O=>{var b=Qa();b.__click=[Wa,a];var j=f(b);La(j,{}),v(b),u(O,b)},O=>{var b=ts();b.__click=[Xa,a];var j=f(b);Da(j,{}),v(b),u(O,b)}),u(y,L)},$$slots:{default:!0}}),v(l);var m=C(l,2);Ut(m,21,()=>z.playlistArtists,Zt,(y,S)=>{Ja(y,{get topArtist(){return o(S)},get toastStore(){return t.toastStore}})}),v(m),u(s,i)}),u(e,r),vt({playlistArtistsSort:n})}Ot(["click"]);var rs=w("<input>");function ns(e,t){ut(t,!0);let n=h(t,"value",15),a=pt(t,["$$slots","$$events","$$legacy","value"]);var r=rs();Tt(r);let c;T(()=>c=gt(r,c,{class:"input",type:"text",disabled:!z.isUpdatable,...a})),Kt(r,n),u(e,r),vt()}var dt=Te(()=>z),ls=w("<!> playlist",1),is=w('<div class="grid grid-cols-6"><div class="col-span-5"><label class="label"><span>Title</span> <!></label></div> <div><!></div></div> <label class="label"><span>Description</span> <textarea class="textarea" rows="4" placeholder=""></textarea></label>',1),os=w('<form class="mb-10 space-y-2"><!></form>');function cs(e,t){ut(t,!1),Dt();var n=os(),a=f(n);at(a,()=>dt().playlist,r=>{var c=is(),s=U(c),i=f(s),l=f(i),d=C(f(l),2),g=Ft(()=>!dt().isUpdatable);ns(d,{get value(){return dt().playlist.title},set value(p){dt(dt().playlist.title=p)},placeholder:"title",get disabled(){return o(g)},$$legacy:!0}),v(l),v(i);var m=C(i,2),y=f(m),S=Ft(()=>!dt().isUpdatable);ea(y,{name:"slider-label",get checked(){return dt().playlist.public},set checked(p){dt(dt().playlist.public=p)},get disabled(){return o(S)},children:(p,O)=>{var b=ls(),j=U(b);at(j,()=>dt().playlist.public,E=>{var q=Lt("Public");u(E,q)},E=>{var q=Lt("Private");u(E,q)}),At(),u(p,b)},$$slots:{default:!0},$$legacy:!0}),v(m),v(s);var L=C(s,2),D=C(f(L),2);Fe(D),v(L),T(()=>{$t(l,"input-error",!dt().playlist.title),D.disabled=!dt().isUpdatable,$t(D,"input-error",!dt().playlist.description)}),Kt(D,()=>dt().playlist.description,p=>dt(dt().playlist.description=p)),u(r,c)}),v(n),u(e,n),vt()}var ds=_t('<svg><path fill="currentColor" d="M176 128a12 12 0 0 1-5.17 9.87l-52 36A12 12 0 0 1 100 164V92a12 12 0 0 1 18.83-9.87l52 36A12 12 0 0 1 176 128m60 0A108 108 0 1 1 128 20a108.12 108.12 0 0 1 108 108m-24 0a84 84 0 1 0-84 84a84.09 84.09 0 0 0 84-84"></path></svg>');function us(e,t){const n=pt(t,["$$slots","$$events","$$legacy"]);var a=ds();let r;T(()=>r=gt(a,r,{viewBox:"0 0 256 256",width:"1.2em",height:"1.2em",...n},void 0,!0)),u(e,a)}var vs=_t('<svg><path fill="currentColor" d="M128 20a108 108 0 1 0 108 108A108.12 108.12 0 0 0 128 20m0 192a84 84 0 1 1 84-84a84.09 84.09 0 0 1-84 84M116 96v64a12 12 0 0 1-24 0V96a12 12 0 0 1 24 0m48 0v64a12 12 0 0 1-24 0V96a12 12 0 0 1 24 0"></path></svg>');function fs(e,t){const n=pt(t,["$$slots","$$events","$$legacy"]);var a=vs();let r;T(()=>r=gt(a,r,{viewBox:"0 0 256 256",width:"1.2em",height:"1.2em",...n},void 0,!0)),u(e,a)}function gs(e,t,n){t()&&n(!n())}var ms=w('<audio></audio> <span><button type="button" class="button-icon"><!></button></span>',1);function hs(e,t){let n=h(t,"loop",3,!1),a=h(t,"enabled",3,!0),r=h(t,"paused",7,!0);var c=ms(),s=U(c),i=C(s,2),l=f(i);l.__click=[gs,a,r];var d=f(l);at(d,r,g=>{us(g,{})},g=>{fs(g,{})}),v(l),v(i),T(()=>{et(s,"src",t.src),s.loop=n(),$t(i,"text-gray-500",!a())}),Ge(s,r),u(e,c)}Ot(["click"]);var ps=w('<td style="vertical-align:middle"><div><!></div></td>');function Pt(e,t){ut(t,!0);let n=h(t,"justify",3,"center"),a=h(t,"title",3,""),r=h(t,"class",3,"");var c=ps(),s=f(c),i=f(s);ue(i,()=>t.children??fe),v(s),v(c),T(()=>{et(c,"title",""+a()),tt(c,r()),tt(s,`flex items-center justify-${n()??""} gap-x-2 h-full`)}),u(e,c),vt()}var bs=_t('<svg><path fill="currentColor" d="M243 96a20.33 20.33 0 0 0-17.74-14l-56.59-4.57l-21.84-52.81a20.36 20.36 0 0 0-37.66 0L87.35 77.44L30.76 82a20.45 20.45 0 0 0-11.66 35.88l43.18 37.24l-13.2 55.7A20.37 20.37 0 0 0 79.57 233L128 203.19L176.43 233a20.39 20.39 0 0 0 30.49-22.15l-13.2-55.7l43.18-37.24A20.43 20.43 0 0 0 243 96m-70.47 45.7a12 12 0 0 0-3.84 11.86L181.58 208l-47.29-29.08a12 12 0 0 0-12.58 0L74.42 208l12.89-54.4a12 12 0 0 0-3.84-11.86l-42.27-36.5l55.4-4.47a12 12 0 0 0 10.13-7.38L128 41.89l21.27 51.5a12 12 0 0 0 10.13 7.38l55.4 4.47Z"></path></svg>');function _s(e,t){const n=pt(t,["$$slots","$$events","$$legacy"]);var a=bs();let r;T(()=>r=gt(a,r,{viewBox:"0 0 256 256",width:"1.2em",height:"1.2em",...n},void 0,!0)),u(e,a)}var ys=_t('<svg><g fill="currentColor"><path d="m229.06 108.79l-48.7 42l14.88 62.79a8.4 8.4 0 0 1-12.52 9.17L128 189.09l-54.72 33.65a8.4 8.4 0 0 1-12.52-9.17l14.88-62.79l-48.7-42A8.46 8.46 0 0 1 31.73 94l63.91-5.2l24.62-59.6a8.36 8.36 0 0 1 15.48 0l24.62 59.6l63.91 5.2a8.46 8.46 0 0 1 4.79 14.79" opacity=".2"></path><path d="M239.18 97.26A16.38 16.38 0 0 0 224.92 86l-59-4.76l-22.78-55.09a16.36 16.36 0 0 0-30.27 0L90.11 81.23L31.08 86a16.46 16.46 0 0 0-9.37 28.86l45 38.83L53 211.75a16.38 16.38 0 0 0 24.5 17.82l50.5-31.08l50.53 31.08A16.4 16.4 0 0 0 203 211.75l-13.76-58.07l45-38.83a16.43 16.43 0 0 0 4.94-17.59m-15.34 5.47l-48.7 42a8 8 0 0 0-2.56 7.91l14.88 62.8a.37.37 0 0 1-.17.48c-.18.14-.23.11-.38 0l-54.72-33.65a8 8 0 0 0-8.38 0l-54.72 33.67c-.15.09-.19.12-.38 0a.37.37 0 0 1-.17-.48l14.88-62.8a8 8 0 0 0-2.56-7.91l-48.7-42c-.12-.1-.23-.19-.13-.5s.18-.27.33-.29l63.92-5.16a8 8 0 0 0 6.72-4.94l24.62-59.61c.08-.17.11-.25.35-.25s.27.08.35.25L153 91.86a8 8 0 0 0 6.75 4.92l63.92 5.16c.15 0 .24 0 .33.29s0 .4-.16.5"></path></g></svg>');function ks(e,t){const n=pt(t,["$$slots","$$events","$$legacy"]);var a=ys();let r;T(()=>r=gt(a,r,{viewBox:"0 0 256 256",width:"1.2em",height:"1.2em",...n},void 0,!0)),u(e,a)}var xs=_t('<svg><path fill="currentColor" d="m234.29 114.85l-45 38.83L203 211.75a16.4 16.4 0 0 1-24.5 17.82L128 198.49l-50.53 31.08A16.4 16.4 0 0 1 53 211.75l13.76-58.07l-45-38.83A16.46 16.46 0 0 1 31.08 86l59-4.76l22.76-55.08a16.36 16.36 0 0 1 30.27 0l22.75 55.08l59 4.76a16.46 16.46 0 0 1 9.37 28.86Z"></path></svg>');function ws(e,t){const n=pt(t,["$$slots","$$events","$$legacy"]);var a=xs();let r;T(()=>r=gt(a,r,{viewBox:"0 0 256 256",width:"1.2em",height:"1.2em",...n},void 0,!0)),u(e,a)}var $s=w('<span><!> <span class="btn-group-vertical btn btn-sm gap-y-1"><button class="!p-0 "><!></button> <button class="!p-0"><!></button></span></span>');function de(e,t){ut(t,!0);let n=h(t,"addTitle",3,"add all album titles to the playlist"),a=h(t,"removeTitle",3,"deselect all album titles from the playlist"),r=St("");var c=$s(),s=f(c);ue(s,()=>t.children??fe);var i=C(s,2),l=f(i);l.__click=function(...y){var S;(S=t.onAdd)==null||S.apply(this,y)};var d=f(l);ee(d,{}),v(l);var g=C(l,2);g.__click=function(...y){var S;(S=t.onRemove)==null||S.apply(this,y)};var m=f(g);ke(m,{}),v(g),v(i),v(c),T(()=>{tt(c,`flex flex-row justify-between w-full items-center py-1 gap-x-2 ${o(r)??""}`),et(l,"title",n()),et(g,"title",a())}),K("pointerenter",l,()=>x(r,"variant-ghost-success")),K("pointerleave",l,()=>x(r,"")),K("pointerenter",g,()=>x(r,"variant-ghost-error")),K("pointerleave",g,()=>x(r,"")),u(e,c),vt()}Ot(["click"]);var As=(e,t)=>{t(e)},Ps=w('<input type="checkbox" class="checkbox">'),Ts=w("<span></span>"),Ss=w('<!> <a title="open track in Deezer web interface"><span class="whitespace-normal"> </span></a>',1),Cs=w('<img class="largeonly" alt="album cover"> <span class="whitespace-normal"> </span>',1),Is=w('<a title="open album in Deezer web interface"><!></a>'),Bs=w('<img class="largeonly" alt="artist"> <span class="whitespace-normal"> </span>',1),Rs=w('<a title="open artist in Deezer web interface"><!></a>'),Ls=w(' <span class="grow"></span>',1),zs=w("<tr><!><!><!><!><!><!><!></tr>"),Ds=w('<div class="table-container"><table class="table table-compact my-4"><thead><tr><td colspan="3"><span> </span></td><td colspan="4"><input class="input" title="Input (search)" type="search" placeholder="Search..."></td></tr><tr><th><input type="checkbox" class="checkbox"></th><th class="largeonly">Pos.</th><th>Title</th><th class="max-w-xs">Album</th><th class="max-w-xs">Artist</th><th class="largeonly">rank</th><th class="largeonly w-16">duration</th></tr></thead><tbody></tbody></table> <!></div>');function Os(e,t){ut(t,!0);function n(_){return!_.inPlaylist&&_.selected?"!text-lime-500":_.inPlaylist&&!_.selected?"!line-through":""}function a(_,I){return I.find(H=>H.id===_.artist.id)}let r=St(xt({page:0,limit:10,size:10,amounts:[10,20,50,100]}));ge(()=>{o(r).size=z.trackSelections.length});let c=St(""),s=wt(()=>z.trackSelections.filter(_=>!o(c)||JSON.stringify(_.track).toLowerCase().includes(o(c).toLowerCase())).slice(o(r).page*o(r).limit,o(r).page*o(r).limit+o(r).limit)),i=wt(()=>z.trackSelections.reduce((_,I)=>Math.max(_,I.track.rank),0));const l=Ie.humanizer({language:"shortEn",languages:{shortEn:{y:()=>"y.",mo:()=>"mo.",w:()=>"w.",d:()=>"d.",h:()=>"h.",m:()=>"m.",s:()=>"s.",ms:()=>"ms"}},units:["m","s"],largest:2});function d(_){const I=_.target;o(s).forEach(H=>H.selected=I.checked)}var g=Ds(),m=f(g),y=f(m),S=f(y),L=f(S),D=f(L);const p=wt(()=>{var _;return((_=z.trackSelections)==null?void 0:_.filter(I=>I.selected).length)??""}),O=wt(()=>z.trackSelections.filter(_=>_.inPlaylist).length??"");var b=f(D);T(()=>ht(b,`${o(p)} selected
                            Tracks (${o(O)}
                            in playlist)`)),v(D),v(L);var j=C(L),E=f(j);Tt(E),v(j),v(S);var q=C(S),st=f(q),G=f(st);Tt(G),T(()=>Ue(G,o(s).filter(_=>_.selected).length===o(s).length&&o(s).length>0)),T(()=>G.indeterminate=o(s).filter(_=>_.selected).length!==o(s).length&&o(s).filter(_=>_.selected).length>0),G.__change=[As,d],v(st),At(6),v(q),v(y);var Y=C(y);Ut(Y,21,()=>o(s),Zt,(_,I,H)=>{var R=zs();const A=wt(()=>o(I).track),N=wt(()=>n(o(I)));var X=f(R);Pt(X,{children:(P,M)=>{var F=Ps();Tt(F),ve(F,()=>o(I).selected,rt=>o(I).selected=rt),u(P,F)},$$slots:{default:!0}});var it=C(X);Pt(it,{class:"largeonly",children:(P,M)=>{var F=Ts();F.textContent=H+1,u(P,F)},$$slots:{default:!0}});var Q=C(it);Pt(Q,{justify:"start",children:(P,M)=>{var F=Ss(),rt=U(F),ot=wt(()=>{var kt;return(kt=o(A))==null?void 0:kt.preview}),lt=wt(()=>{var kt;return(kt=o(A))==null?void 0:kt.readable});hs(rt,{get src(){return o(ot)},get enabled(){return o(lt)}});var V=C(rt,2),It=f(V),yt=f(It,!0);v(It),v(V),T(()=>{et(V,"href",o(A).link),ht(yt,o(A).title)}),u(P,F)},$$slots:{default:!0}});var nt=C(Q);Pt(nt,{justify:"start",children:(P,M)=>{de(P,{addTitle:"add all album titles to the playlist",removeTitle:"deselect all album titles from the playlist",onAdd:()=>Ea(o(A).album,z.trackSelections),onRemove:()=>Oa(o(A).album.id,z.trackSelections),children:(F,rt)=>{var ot=Is(),lt=f(ot);jt(lt,{children:(V,It)=>{var yt=Cs(),kt=U(yt),Et=C(kt,2),qt=f(Et,!0);v(Et),T(()=>{et(kt,"src",o(A).album.cover_small),ht(qt,o(A).album.title)}),u(V,yt)},$$slots:{default:!0}}),v(ot),T(()=>et(ot,"href",`https://www.deezer.com/album/${o(A).album.id??""}`)),u(F,ot)},$$slots:{default:!0}})},$$slots:{default:!0}});var mt=C(nt);Pt(mt,{justify:"start",children:(P,M)=>{de(P,{addTitle:"add all artist titles to the playlist",removeTitle:"deselect all artist titles from the playlist",onAdd:()=>ae(o(A).artist,z.trackSelections,t.toastStore),onRemove:()=>ye(o(A).artist.id,z.trackSelections),children:(F,rt)=>{var ot=Rs(),lt=f(ot);jt(lt,{children:(V,It)=>{var yt=Bs(),kt=U(yt);T(()=>{var se;return et(kt,"src",(se=a(o(A),z.playlistArtists))==null?void 0:se.picture_small)});var Et=C(kt,2),qt=f(Et,!0);v(Et),T(()=>ht(qt,o(A).artist.name)),u(V,yt)},$$slots:{default:!0}}),v(ot),T(()=>et(ot,"href",o(A).artist.link)),u(F,ot)},$$slots:{default:!0}})},$$slots:{default:!0}});var $=C(mt);Pt($,{class:"largeonly",get title(){return o(A).rank},children:(P,M)=>{var F=wt(()=>5*o(A).rank/o(i));Qe(P,{get value(){return o(F)},max:5,regionIcon:"!m-0",empty:V=>{_s(V,{})},half:V=>{ks(V,{})},full:V=>{ws(V,{})},$$slots:{empty:!0,half:!0,full:!0}})},$$slots:{default:!0}});var k=C($);Pt(k,{class:"largeonly",children:(P,M)=>{At();var F=Ls(),rt=U(F);T(()=>ht(rt,`${l(o(A).duration*1e3)??""} `)),At(),u(P,F)},$$slots:{default:!0}}),v(R),T(()=>{tt(R,o(N)),$t(R,"!text-red-500",!o(A).readable)}),u(_,R)}),v(Y),v(m);var W=C(m,2);Be(W,{get settings(){return o(r)},set settings(_){x(r,xt(_))},showFirstLastButtons:!0,showPreviousNextButtons:!0}),v(g),Kt(E,()=>o(c),_=>x(c,_)),u(e,g),vt()}Ot(["change"]);async function Es(e,t,n,a){if(!e)return;const r={request_method:"POST"};e.title&&(r.title=e.title),e.description&&(r.description=e.description),e.public!==void 0&&(r.public=e.public);try{const c=await zt({apiPath:`/playlist/${e.id}`,searchParams:r});n.trigger({message:`Updated playlist: ${c?"OK":"KO"}`,timeout:3e3})}catch(c){n.trigger({message:`Updated playlist: error ${c}`,timeout:3e3})}await Ns(e,t,n,a)}async function Ns(e,t,n,a){try{const r=t.filter(s=>s.selected&&!s.inPlaylist).map(s=>s.track.id);await Gt(e,r,"POST","songs",a);const c=t.filter(s=>!s.selected&&s.inPlaylist).map(s=>s.track.id);if(await Gt(e,c,"DELETE","songs",a),r.length>0){const s=t.filter(i=>i.selected).map(i=>i.track.id);await Gt(e,s,"POST","order",a)}if(a.set(void 0),r.length||c.length){const s=n.trigger({message:"Updated playlist tracks, refreshing playlist data"});await qe(),n.close(s)}}catch(r){n.trigger({message:`Updated playlist tracks: error ${r}`,timeout:3e3})}finally{a.set(void 0)}}async function Gt(e,t,n,a,r){if(!t.length)return;r.set({message:`sending 0/${t.length} ${n} ${a} `,value:0,max:t.length});let c=0;const s=100;for(const i of js(t,s)){c+=s,r.set({message:`sending ${c} / ${t.length} ${n} ${a} `,value:c,max:t.length}),console.log(`sending ${c} / ${t.length} ${n} ${a} `),console.log(`sending ${n} ${a}=${JSON.stringify(i)}`);const l={request_method:n};l[a]=i.join(",");const d=await zt({apiPath:`/playlist/${e.id}/tracks`,searchParams:l});if(console.log({updateResult:d}),!d)throw new Error(`unable to send ${n} ${a}=${JSON.stringify(i)}`)}}function js(e,t){const n=[];for(let a=0;a<e.length;a+=t)n.push(e.slice(a,a+t));return n}var Hs=w('<span class="my-6"><span> </span> <progress></progress></span>');function Ms(e,t){ut(t,!0);const n=Jt(),a=()=>Nt(t.updateTracksProgress,"$updateTracksProgress",n);var r=ct(),c=U(r);at(c,a,s=>{var i=Hs(),l=f(i),d=f(l,!0);v(l);var g=C(l,2);v(i),T(()=>{ht(d,a().message),Ke(g,a().value),et(g,"max",a().max)}),u(s,i)}),u(e,r),vt()}var Fs=w("<p><i>you can add/remove all tracks from a playlist artist from here</i></p> <!>",1),Us=w('<p class="my-4"><i>you can add all tracks from a new artist from here</i></p> <!>',1),Ks=w("<!> <!> <!> <!>",1),Js=w('<span><span class="h3"> </span> <!></span>');function or(e,t){ut(t,!0);const n=Jt(),a=()=>Nt(c,"$updateTracksProgress",n),r=He(),c=me(void 0);function s(p){var O,b,j;z.isUpdatable=((O=p.currentUser)==null?void 0:O.id)===((j=(b=p.playlist)==null?void 0:b.creator)==null?void 0:j.id),z.playlist=p.playlist,z.playlistArtists=p.topArtists,z.trackSelections=p.playlist.tracks.data.map(E=>({track:E,inPlaylist:!0,selected:!0}))}ge(()=>{s(t.data)});async function i(){try{await ba(z.trackSelections,r,c)}finally{c.set(void 0)}}function l(){Na(z.trackSelections,r)}function d(p){z.trackSelections.length===0&&z.playlist&&(z.playlist.title=p.name+" - Full Discography"),z.playlistArtists.findIndex(b=>b.id===p.id)<0&&z.playlistArtists.push(p),ae(p,z.trackSelections,r)}const g={DESCRIPTION:0,TRACKS:1,PLAYLIST_ARTISTS:2,SEARCH_ARTISTS:3};let m=St(xt(g.TRACKS));const y=Me(),S=[{onclick:()=>Es(z.playlist,z.trackSelections,r,c),title:"Update playlist",icon:ma},{onclick:()=>i(),title:"Fix missing tracks",icon:pa,disabled:()=>z.trackSelections.filter(p=>p.selected&&!p.track.readable).length===0},{onclick:()=>l(),title:"Clear deselected tracks",icon:fa,disabled:()=>z.trackSelections.filter(p=>!p.selected&&!p.inPlaylist).length===0}];Oe(()=>{var p;z.isUpdatable&&y.update(O=>[...O,...S]),(p=z.playlist)!=null&&p.tracks.data.length||x(m,xt(g.SEARCH_ARTISTS))}),Ee(()=>{y.update(p=>p.filter(O=>!S.includes(O)))});var L=ct(),D=U(L);at(D,()=>z.playlist,p=>{Re(p,{pageHeader:b=>{Ms(b,{updateTracksProgress:c})},children:(b,j)=>{var E=Js(),q=f(E),st=f(q,!0);v(q);var G=C(q,2);ra(G,{panel:W=>{var _=ct(),I=U(_);at(I,()=>o(m)===g.DESCRIPTION,H=>{cs(H,{})},H=>{var R=ct(),A=U(R);at(A,()=>o(m)===g.TRACKS,N=>{Os(N,{toastStore:r})},N=>{var X=ct(),it=U(X);at(it,()=>o(m)===g.PLAYLIST_ARTISTS,Q=>{var nt=Fs(),mt=C(U(nt),2);ss(mt,{toastStore:r}),u(Q,nt)},Q=>{var nt=ct(),mt=U(nt);at(mt,()=>o(m)===g.SEARCH_ARTISTS,$=>{var k=Us(),P=C(U(k),2);Ba(P,{onArtistSelection:M=>d(M)}),u($,k)},null,!0),u(Q,nt)},!0),u(N,X)},!0),u(H,R)}),u(W,_)},children:(W,_)=>{var I=Ks(),H=U(I);Mt(H,{get group(){return o(m)},set group(X){x(m,xt(X))},name:"tabTracks",get value(){return g.TRACKS},children:(X,it)=>{At();var Q=Lt("tracks");u(X,Q)},$$slots:{default:!0}});var R=C(H,2);Mt(R,{get group(){return o(m)},set group(X){x(m,xt(X))},name:"tabMain",get value(){return g.DESCRIPTION},children:(X,it)=>{At();var Q=Lt("details");u(X,Q)},$$slots:{default:!0}});var A=C(R,2);Mt(A,{get group(){return o(m)},set group(X){x(m,xt(X))},name:"tabPlaylistArtists",get value(){return g.PLAYLIST_ARTISTS},children:(X,it)=>{At();var Q=Lt("playlist artists");u(X,Q)},$$slots:{default:!0}});var N=C(A,2);at(N,()=>z.isUpdatable,X=>{Mt(X,{get group(){return o(m)},set group(it){x(m,xt(it))},name:"tabSearchArtists",get value(){return g.SEARCH_ARTISTS},children:(it,Q)=>{At();var nt=Lt("search new artists");u(it,nt)},$$slots:{default:!0}})}),u(W,I)},$$slots:{panel:!0,default:!0}}),v(E),T(()=>{$t(E,"opacity-50",a()),ht(st,z.playlist.title)}),u(b,E)},$$slots:{pageHeader:!0,default:!0}})}),u(e,L),vt()}export{or as component,ir as universal};
